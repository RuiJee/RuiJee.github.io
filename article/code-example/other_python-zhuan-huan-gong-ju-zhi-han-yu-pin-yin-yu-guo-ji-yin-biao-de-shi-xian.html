<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>python转换工具之汉语拼音与国际音标的实现</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Alex">

    <!-- Le styles -->
    <link rel="stylesheet" href="/theme/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="/theme/css/nest.css" type="text/css" />
    <link rel="stylesheet" href="/theme/css/fonts.css" type="text/css" />
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
      .tag-1 {
        font-size: 13pt;
      }
      .tag-2 {
        font-size: 10pt;
      }
      .tag-2 {
        font-size: 8pt;
      }
      .tag-4 {
        font-size: 6pt;
     }
    </style>
    <link href="/theme/css/bootstrap-responsive.min.css" rel="stylesheet">
        <link href="/theme/css/font-awesome.css" rel="stylesheet">

    <link href="/theme/css/pygments.css" rel="stylesheet">

    <!--<link href="/theme/css/base.css" rel="stylesheet">-->

    <script src="/theme/js/jquery-1.7.2.min.js"></script>



    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/theme/images/favicon.ico">
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/theme/images/apple-touch-icon-114x114.png">

    <link href="/" type="application/atom+xml" rel="alternate" title="Alex's Blog ATOM Feed" />

  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/index.html">Alex's Blog </a>
          <div class="nav-collapse">
            <ul class="nav">
                          <li class="divider-vertical"></li>
                  <li class="active">
                    <a href="/category/code-example/index.html">
						<i class="icon-folder-open icon-large"></i>Code Example
					</a>
                  </li>
                  <li >
                    <a href="/category/linux/index.html">
						<i class="icon-folder-open icon-large"></i>Linux
					</a>
                  </li>
                  <li >
                    <a href="/category/pa-chong-ji-zhu/index.html">
						<i class="icon-folder-open icon-large"></i>爬虫技术
					</a>
                  </li>
                  <li >
                    <a href="/category/pythonji-zhu/index.html">
						<i class="icon-folder-open icon-large"></i>Python技术
					</a>
                  </li>
                              <!--<li ><a href="/categories.html"><i class="icon-folder-close icon-large"></i>Categories</a></li>-->
                                <li><a href="/tags.html"><i class="icon-tags icon-large"></i>Tags</a></li>
                          <ul class="nav pull-right">

                                <li><a href="/archives.html"><i class="icon-th-list"></i>文章列表</a></li>
                          </ul>

            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <div class="span9" id="content">
<section id="content">
        <article>
                <header>
                        <h1>
                                <a href=""
                                        rel="bookmark"
                                        title="Permalink to python转换工具之汉语拼音与国际音标的实现">
                                        python转换工具之汉语拼音与国际音标的实现
                                </a>
                        </h1>
                </header>
                <div class="entry-content">
                <div class="well">
<footer class="post-info">
<span class="label">Date</span>
<abbr class="published" title="2018-01-01T00:00:00+08:00">
        <i class="icon-calendar"></i>Mon 01 January 2018
</abbr>
<span class="label">By</span>
<a href="/author/alex/"><i class="icon-user"></i>Alex</a>
<span class="label">Category</span>
<a href="/category/code-example/index.html"><i class="icon-folder-open"></i>Code Example</a>.


<span class="label">Tags</span>
	<a href="/tag/code_other/index.html"><i class="icon-tag"></i>code_other</a>

</footer><!-- /.post-info -->                </div>
                <div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># This file has following encoding: utf-8</span>

<span class="c1">######################## 模块导入 ########################</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">re</span>
<span class="c1">######################## 全局变量 ########################</span>
<span class="c1"># 三种字符集标志</span>
<span class="n">GB18030</span><span class="p">,</span> <span class="n">GBK</span><span class="p">,</span> <span class="n">UTF8</span> <span class="o">=</span> <span class="s2">&quot;gb18030&quot;</span><span class="p">,</span> <span class="s2">&quot;gbk&quot;</span><span class="p">,</span> <span class="s2">&quot;utf8&quot;</span>
<span class="c1"># 字符编码页解码失败标志</span>
<span class="n">decodingFailed</span> <span class="o">=</span> <span class="bp">False</span>  <span class="c1"># 初始状态：关闭</span>
<span class="c1"># 正则表达式替换命令元组和内部标志</span>
<span class="n">cmdPairTuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">()</span>  <span class="c1"># 预备空对象</span>
<span class="n">PATTERN</span><span class="p">,</span> <span class="n">SUBST</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>   <span class="c1"># 匹配段和替换段</span>
<span class="c1"># 经过编译的正则表达式对象列表</span>
<span class="n">reList</span> <span class="o">=</span> <span class="p">[]</span>             <span class="c1"># 预备空对象</span>
<span class="c1"># 创建正则表达式替换命令元组的默认设置表（固定集合对象）</span>
<span class="n">defaultPrefSet</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span>
<span class="c1">### 以下各行字符串，凡行首用#号注释者均表示无效；</span>
<span class="c1">### 凡行首未用#号注释者均有效，效用如后面注释所述：</span>
<span class="c1"># &quot;NUMBER_2_BY_AR4&quot;,                      # 数字“二”有大开口度韵腹</span>
<span class="c1"># &quot;AI_INC_NEAR_OPEN_FRONT&quot;,               # ai/uai韵腹为舌面前次开元音</span>
<span class="c1"># &quot;AIR_ANR_INC_NEAR_OPEN_CENTRAL&quot;,        # air/anr韵腹为舌面央次低元音</span>
<span class="c1"># &quot;CENTRAL_A_BY_SMALLCAPS_A&quot;,             # “央a”采用小型大写[A]标明</span>
<span class="c1"># &quot;IE_YUE_INC_SMALLCAPS_E&quot;,               # ie/yue采用小型大写[E]标明</span>
<span class="c1"># &quot;IE_YUE_INC_E&quot;,                         # ie/yue采用[e]标明（覆盖上一条）</span>
<span class="c1"># &quot;IAN_YUAN_AS_AN&quot;,                       # ian/yuan韵腹和an一样</span>
<span class="c1"># &quot;ONLY_YUAN_AS_AN&quot;,                      # 仅yuan韵腹和an一样（覆盖上一条）</span>
<span class="c1"># &quot;OU_INC_SCHWA&quot;,                         # ou/iou采用舌面央中元音韵腹</span>
<span class="c1"># &quot;IONG_BY_IUNG&quot;,                         # iong韵母采用i韵头u韵腹</span>
<span class="c1"># &quot;ASPIRATE_BY_TURNED_COMMA&quot;,             # 采用反逗号弱送气符号</span>
<span class="c1"># &quot;RHOTICITY_BY_RHOTIC_HOOK&quot;,             # 儿化韵卷舌动作采用卷舌小钩</span>
<span class="c1"># &quot;ONLY_ER_BY_RHOTIC_HOOK&quot;,               # 只有er音节卷舌动作采用卷舌小钩</span>
<span class="c1"># &quot;INITIAL_R_BY_VED_RETRO_FRIC&quot;,          # 声母r为卷舌浊擦音而非卷舌通音</span>
<span class="c1"># &quot;R_TURNED_WITH_HOOK&quot;,                   # 严格采用卷舌通音符号</span>
<span class="c1"># &quot;TRANSITIONAL_SCHWA_IN_ING&quot;,            # ing有舌面央中元音韵腹</span>
<span class="c1"># &quot;TRANSITIONAL_SCHWA_IN_UEN&quot;,            # 合口un有舌面央中元音韵腹</span>
<span class="c1"># &quot;NO_TRANSITIONAL_U&quot;,                    # bo/po/mo/fo没有[u]韵头</span>
<span class="c1"># &quot;SYLLABLE_JUNCTURE_BY_PLUS&quot;,            # 音节间断采用开音渡+号而非.号</span>
<span class="c1"># &quot;HTML_SUP_TAG_FOR_TONE_VALUE&quot;,          # 调值采用HTML上标标签格式</span>
<span class="c1"># &quot;HIDE_ALL_TONE_VALUE&quot;,                  # 隐藏所有声调转换</span>
<span class="c1">### 以下选项仅存设想，目前尚未实现：</span>
<span class="c1"># &quot;RETROFLEX_INITIAL_STANDALONE&quot;,         # 卷舌声母可成音节而无需舌尖元音</span>
<span class="c1"># &quot;ZERO_INITIAL_HAS_CONSONANT&quot;,           # 零声母有辅音</span>
<span class="p">])</span>
<span class="c1"># 正则表达式替换命令元组一揽子创建设置方案（元组，[0]位为说明）</span>
<span class="n">recipeLinWang1992</span> <span class="o">=</span> <span class="p">(</span>  <span class="sa">U</span><span class="s2">&quot;林焘、王理嘉《语音学教程》&quot;</span><span class="p">,</span>
<span class="s2">&quot;NO_TRANSITIONAL_U&quot;</span><span class="p">,</span> <span class="s2">&quot;ASPIRATE_BY_TURNED_COMMA&quot;</span><span class="p">,</span> <span class="s2">&quot;AI_INC_NEAR_OPEN_FRONT&quot;</span>
<span class="p">)</span>
<span class="n">recipeBeidaCN2004</span> <span class="o">=</span> <span class="p">(</span>  <span class="sa">U</span><span class="s2">&quot;北京大学中文系《现代汉语》（重排本）&quot;</span><span class="p">,</span>
<span class="s2">&quot;NO_TRANSITIONAL_U&quot;</span><span class="p">,</span> <span class="s2">&quot;ASPIRATE_BY_TURNED_COMMA&quot;</span><span class="p">,</span> <span class="s2">&quot;INITIAL_R_BY_VED_RETRO_FRIC&quot;</span><span class="p">,</span>
<span class="s2">&quot;TRANSITIONAL_SCHWA_IN_UEN&quot;</span><span class="p">,</span> <span class="s2">&quot;IONG_BY_IUNG&quot;</span><span class="p">,</span> <span class="s2">&quot;IAN_YUAN_AS_AN&quot;</span>
<span class="p">)</span>
<span class="n">recipeHuangLiao2002</span> <span class="o">=</span> <span class="p">(</span><span class="sa">U</span><span class="s2">&quot;黄伯荣、廖序东《现代汉语》（增订三版）&quot;</span><span class="p">,</span>
<span class="s2">&quot;NO_TRANSITIONAL_U&quot;</span><span class="p">,</span> <span class="s2">&quot;ASPIRATE_BY_TURNED_COMMA&quot;</span><span class="p">,</span> <span class="s2">&quot;CENTRAL_A_BY_SMALLCAPS_A&quot;</span><span class="p">,</span>
<span class="s2">&quot;TRANSITIONAL_SCHWA_IN_UEN&quot;</span><span class="p">,</span> <span class="s2">&quot;ONLY_YUAN_AS_AN&quot;</span><span class="p">,</span> <span class="s2">&quot;ONLY_ER_BY_RHOTIC_HOOK&quot;</span><span class="p">,</span>
<span class="s2">&quot;INITIAL_R_BY_VED_RETRO_FRIC&quot;</span>
<span class="p">)</span>
<span class="n">recipeYangZhou1995</span> <span class="o">=</span> <span class="p">(</span> <span class="sa">U</span><span class="s2">&quot;杨润陆、周一民《现代汉语》（北师大文学院教材）&quot;</span><span class="p">,</span>
<span class="s2">&quot;NO_TRANSITIONAL_U&quot;</span><span class="p">,</span> <span class="s2">&quot;ASPIRATE_BY_TURNED_COMMA&quot;</span><span class="p">,</span> <span class="s2">&quot;TRANSITIONAL_SCHWA_IN_UEN&quot;</span><span class="p">,</span>
<span class="s2">&quot;INITIAL_R_BY_VED_RETRO_FRIC&quot;</span>
<span class="p">)</span>
<span class="n">recipeYuan2001</span> <span class="o">=</span> <span class="p">(</span>     <span class="sa">U</span><span class="s2">&quot;袁家骅等《汉语方言概要》（第二版重排）&quot;</span><span class="p">,</span>
<span class="s2">&quot;NO_TRANSITIONAL_U&quot;</span><span class="p">,</span> <span class="s2">&quot;ASPIRATE_BY_TURNED_COMMA&quot;</span><span class="p">,</span> <span class="s2">&quot;INITIAL_R_BY_VED_RETRO_FRIC&quot;</span><span class="p">,</span>
<span class="s2">&quot;ONLY_ER_BY_RHOTIC_HOOK&quot;</span><span class="p">,</span> <span class="s2">&quot;IAN_YUAN_AS_AN&quot;</span><span class="p">,</span> <span class="s2">&quot;TRANSITIONAL_SCHWA_IN_UEN&quot;</span><span class="p">,</span>
<span class="s2">&quot;IE_YUE_INC_E&quot;</span>
<span class="p">)</span>
<span class="n">recipeTang2002</span> <span class="o">=</span> <span class="p">(</span>     <span class="sa">U</span><span class="s2">&quot;唐作藩《音韵学教程》（第三版）&quot;</span><span class="p">,</span>
<span class="s2">&quot;NO_TRANSITIONAL_U&quot;</span><span class="p">,</span> <span class="s2">&quot;ASPIRATE_BY_TURNED_COMMA&quot;</span><span class="p">,</span> <span class="s2">&quot;INITIAL_R_BY_VED_RETRO_FRIC&quot;</span><span class="p">,</span>
<span class="s2">&quot;ONLY_ER_BY_RHOTIC_HOOK&quot;</span><span class="p">,</span> <span class="s2">&quot;IAN_YUAN_AS_AN&quot;</span><span class="p">,</span> <span class="s2">&quot;TRANSITIONAL_SCHWA_IN_UEN&quot;</span><span class="p">,</span>
<span class="s2">&quot;IE_YUE_INC_E&quot;</span><span class="p">,</span> <span class="s2">&quot;OU_INC_SCHWA&quot;</span>
<span class="p">)</span>
<span class="c1">#############www.iplaypy.com 函数声明 ########################</span>
<span class="k">def</span> <span class="nf">createCmdPairTuple</span><span class="p">(</span><span class="n">prefSet</span> <span class="o">=</span> <span class="n">defaultPrefSet</span><span class="p">):</span>
    <span class="sa">U</span><span class="sd">&quot;&quot;&quot;创建正则表达式替换命令元组</span>
<span class="sd">    然后编译便于反复使用的匹配段正则表达式对象列表</span>
<span class="sd">    参数prefSet是一个控制命令元组创建的选项设置序列&quot;&quot;&quot;</span>
    <span class="c1">### 预先处理同系列设置的覆盖关系——defaultPrefSet也可能让人动了手脚</span>
    <span class="n">prefSet</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">prefSet</span><span class="p">)</span>           <span class="c1"># 先换为可变集合副本，以防固定类型参数</span>
    <span class="k">if</span> <span class="s2">&quot;IE_YUE_INC_E&quot;</span>    <span class="ow">in</span> <span class="n">prefSet</span> <span class="ow">and</span> <span class="s2">&quot;IE_YUE_INC_SMALLCAPS_E&quot;</span> <span class="ow">in</span> <span class="n">prefSet</span><span class="p">:</span>
        <span class="n">prefSet</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;IE_YUE_INC_SMALLCAPS_E&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;ONLY_YUAN_AS_AN&quot;</span> <span class="ow">in</span> <span class="n">prefSet</span> <span class="ow">and</span> <span class="s2">&quot;IAN_YUAN_AS_AN&quot;</span>         <span class="ow">in</span> <span class="n">prefSet</span><span class="p">:</span>
        <span class="n">prefSet</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;IAN_YUAN_AS_AN&quot;</span><span class="p">)</span>
    <span class="k">global</span> <span class="n">cmdPairTuple</span>
    <span class="n">cmdPairTuple</span> <span class="o">=</span> <span class="p">(</span>
    <span class="c1">### 转换声母前的预处理</span>
    <span class="c1"># 音节间断与隔音符号</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;([aoeiuvüê][1-5]?)([yw])&quot;</span><span class="p">,</span>   <span class="c1"># a/o/e前有元音时必须写隔音符号</span>
                    <span class="sa">UR</span><span class="s2">&quot;\1&#39;\2&quot;</span><span class="p">),</span>      <span class="c1"># 标明不必写出隔音符号的音节间断</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>        <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;+&quot;</span> <span class="k">if</span> <span class="s2">&quot;SYLLABLE_JUNCTURE_BY_PLUS&quot;</span>      <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                    <span class="sa">UR</span><span class="s2">&quot;.&quot;</span><span class="p">)),</span>         <span class="c1"># 音节间断（开音渡）标记</span>
    <span class="c1"># 兼容正规的印刷体字母ɡ/ɑ-&gt;g/a</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ɡ&quot;</span><span class="p">,</span>         <span class="sa">UR</span><span class="s2">&quot;g&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ɑ&quot;</span><span class="p">,</span>         <span class="sa">UR</span><span class="s2">&quot;a&quot;</span><span class="p">),</span>
    <span class="c1"># 特殊的ê韵母，只能搭配零声母（“诶”字等）</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;(ê|ea)&quot;</span><span class="p">,</span>    <span class="sa">UR</span><span class="s2">&quot;ɛ&quot;</span><span class="p">),</span>          <span class="c1"># ea是ê的GF 3006表示</span>
    <span class="c1"># 消除因可以紧邻韵腹充当声母或韵尾的辅音的歧义</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;r([aoeiu])&quot;</span><span class="p">,</span>   <span class="sa">UR</span><span class="s2">&quot;R\1&quot;</span><span class="p">),</span>     <span class="c1"># 声母r暂改为R，以免与卷舌标志r混淆</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;n([aoeiuvü])&quot;</span><span class="p">,</span> <span class="sa">UR</span><span class="s2">&quot;N\1&quot;</span><span class="p">),</span>     <span class="c1"># 声母n暂改为N，以免与韵尾n/ng混淆</span>
    <span class="c1"># 需要排除式匹配转换的韵母</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ng(?![aeu])&quot;</span><span class="p">,</span>  <span class="sa">UR</span><span class="s2">&quot;ŋ&quot;</span><span class="p">),</span>       <span class="c1"># 双字母ng，后鼻音韵尾或自成音节</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;(?&lt;![ieuyüv])e(?![inŋr])&quot;</span><span class="p">,</span>
                       <span class="sa">UR</span><span class="s2">&quot;ɤ&quot;</span><span class="p">),</span>       <span class="c1"># 单韵母e，此前已转换ea和声母r/n</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;(?&lt;![bpmfdtNlgkhjqxzcsRiywuüv])er4&quot;</span><span class="p">,</span>
                      <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ar4&quot;</span> <span class="k">if</span> <span class="s2">&quot;NUMBER_2_BY_AR4&quot;</span>           <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                       <span class="sa">UR</span><span class="s2">&quot;er4&quot;</span><span class="p">)),</span>    <span class="c1"># 数字“二”是否有大开口度韵腹</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;(?&lt;![bpmfdtNlgkhjqxzcsRiywuüv])ar4&quot;</span><span class="p">,</span>
                      <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;a˞4&quot;</span> <span class="k">if</span> <span class="s2">&quot;ONLY_ER_BY_RHOTIC_HOOK&quot;</span>    <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                       <span class="sa">UR</span><span class="s2">&quot;ar4&quot;</span><span class="p">)),</span>    <span class="c1"># 数字“二”也属于er音节，可特别选用小钩</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;a(?![ionŋ])&quot;</span><span class="p">,</span> <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ᴀ&quot;</span> <span class="k">if</span> <span class="s2">&quot;CENTRAL_A_BY_SMALLCAPS_A&quot;</span>    <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                       <span class="sa">UR</span><span class="s2">&quot;a&quot;</span><span class="p">)),</span>      <span class="c1"># “央a”是否用小型大写[A]标明，已转换“二”</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;(?&lt;![bpmfdtNlgkhjqxzcsRiywuüv])er&quot;</span><span class="p">,</span>
                       <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ə˞&quot;</span> <span class="k">if</span> <span class="s2">&quot;ONLY_ER_BY_RHOTIC_HOOK&quot;</span>    <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                        <span class="sa">UR</span><span class="s2">&quot;ər&quot;</span><span class="p">)),</span>    <span class="c1"># 一般的卷舌单韵母er，此前已排除“二”</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;(?&lt;![iuüv])er&quot;</span><span class="p">,</span> <span class="sa">UR</span><span class="s2">&quot;ər&quot;</span><span class="p">),</span>     <span class="c1"># 构成单韵母e的儿化韵的er</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;(?&lt;=[bpmf])o(?![uŋ])&quot;</span><span class="p">,</span>
                      <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;o&quot;</span> <span class="k">if</span> <span class="s2">&quot;NO_TRANSITIONAL_U&quot;</span>           <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                       <span class="sa">UR</span><span class="s2">&quot;uo&quot;</span><span class="p">)),</span>     <span class="c1"># bo/po/mo/fo是否有韵头u</span>
    <span class="c1">### 声母——无需转换m/f/n/l/s/r(但r可根据设置执行转换)</span>
    <span class="c1"># 送气清辅音声母</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;([ptk])&quot;</span><span class="p">,</span>   <span class="sa">UR</span><span class="s2">&quot;\1ʰ&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;q&quot;</span><span class="p">,</span>         <span class="sa">UR</span><span class="s2">&quot;tɕʰ&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;(ch|ĉ)&quot;</span><span class="p">,</span>    <span class="sa">UR</span><span class="s2">&quot;tʂʰ&quot;</span><span class="p">),</span>        <span class="c1"># 后者是ch的注音变体</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;c&quot;</span><span class="p">,</span>         <span class="sa">UR</span><span class="s2">&quot;tsʰ&quot;</span><span class="p">),</span>        <span class="c1"># 此前已排除ch</span>
    <span class="c1"># 不送气清辅音声母</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>         <span class="sa">UR</span><span class="s2">&quot;p&quot;</span><span class="p">),</span>          <span class="c1"># 此前已排除送气的p/t/k</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;d&quot;</span><span class="p">,</span>         <span class="sa">UR</span><span class="s2">&quot;t&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;g&quot;</span><span class="p">,</span>         <span class="sa">UR</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>          <span class="c1"># 此前已排除后鼻音双字母中的g，注意隔音</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;j&quot;</span><span class="p">,</span>         <span class="sa">UR</span><span class="s2">&quot;tɕ&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;(zh|ẑ)&quot;</span><span class="p">,</span>    <span class="sa">UR</span><span class="s2">&quot;tʂ&quot;</span><span class="p">),</span>         <span class="c1"># 后者是zh的注音变体</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;z&quot;</span><span class="p">,</span>         <span class="sa">UR</span><span class="s2">&quot;ts&quot;</span><span class="p">),</span>         <span class="c1"># 此前已排除zh</span>
    <span class="c1"># 擦音声母</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;(sh|ŝ)&quot;</span><span class="p">,</span>    <span class="sa">UR</span><span class="s2">&quot;ʂ&quot;</span><span class="p">),</span>          <span class="c1"># 后者是sh的注音变体</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>         <span class="sa">UR</span><span class="s2">&quot;ɕ&quot;</span><span class="p">),</span>          <span class="c1"># 声母x，排除后再转换h</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>         <span class="sa">UR</span><span class="s2">&quot;x&quot;</span><span class="p">),</span>          <span class="c1"># 声母h，此前已排除zh/ch/sh</span>
    <span class="c1">### 韵母</span>
    <span class="c1"># 舌尖元音韵母</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;(sʰ?)i&quot;</span><span class="p">,</span>    <span class="sa">UR</span><span class="s2">&quot;\1ɿ&quot;</span><span class="p">),</span>        <span class="c1"># zi/ci/si</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;([ʂR]ʰ?)i&quot;</span><span class="p">,</span> <span class="sa">UR</span><span class="s2">&quot;\1ʅ&quot;</span><span class="p">),</span>        <span class="c1"># zhi/chi/shi/ri</span>
    <span class="c1"># 部分韵腹省略表示的韵母+隔音符号和韵头w/y</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;iu&quot;</span><span class="p">,</span>        <span class="sa">UR</span><span class="s2">&quot;iou&quot;</span><span class="p">),</span>        <span class="c1"># 无需转换iou</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ui&quot;</span><span class="p">,</span>        <span class="sa">UR</span><span class="s2">&quot;uei&quot;</span><span class="p">),</span>        <span class="c1"># 无需转换uei</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;wu?&quot;</span><span class="p">,</span>       <span class="sa">UR</span><span class="s2">&quot;u&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;yi?&quot;</span><span class="p">,</span>       <span class="sa">UR</span><span class="s2">&quot;i&quot;</span><span class="p">),</span>          <span class="c1"># 此前已排除iu</span>
    <span class="c1"># 韵头[i]/[y]的韵母</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;iu|[üv]&quot;</span><span class="p">,</span>   <span class="sa">UR</span><span class="s2">&quot;y&quot;</span><span class="p">),</span>          <span class="c1"># 转换ü/v，恢复yu/yue，准备yuan/yun</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ian&quot;</span><span class="p">,</span>      <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ian&quot;</span> <span class="k">if</span> <span class="s2">&quot;IAN_YUAN_AS_AN&quot;</span>               <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                    <span class="sa">UR</span><span class="s2">&quot;iɛn&quot;</span><span class="p">)),</span>       <span class="c1"># 是否认为ian韵腹和an一样</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;yan&quot;</span><span class="p">,</span>      <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;yan&quot;</span> <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;ONLY_YUAN_AS_AN&quot;</span>             <span class="ow">in</span> <span class="n">prefSet</span><span class="p">)</span>
                            <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;IAN_YUAN_AS_AN&quot;</span>              <span class="ow">in</span> <span class="n">prefSet</span><span class="p">)</span> <span class="k">else</span>
                    <span class="sa">UR</span><span class="s2">&quot;yɛn&quot;</span><span class="p">)),</span>       <span class="c1"># 是否认为yuan韵腹和an一样（覆盖上一选项）</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;(ɕʰ?)uan&quot;</span><span class="p">,</span> <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;</span>
<span class="mi">2964</span>
\<span class="mi">1</span><span class="n">yan</span><span class="s2">&quot; if (&quot;</span><span class="n">ONLY_YUAN_AS_AN</span><span class="s2">&quot;           in prefSet)</span>
                              <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;IAN_YUAN_AS_AN&quot;</span>            <span class="ow">in</span> <span class="n">prefSet</span><span class="p">)</span> <span class="k">else</span>
                    <span class="sa">UR</span><span class="s2">&quot;\1yɛn&quot;</span><span class="p">)),</span>     <span class="c1"># {j/q/x}uan，是否认为和an一样</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;(ɕʰ?)u&quot;</span><span class="p">,</span>    <span class="sa">UR</span><span class="s2">&quot;\1y&quot;</span><span class="p">),</span>        <span class="c1"># {j/q/x}u{e/n}韵头，此前已排除{j/q/x}uan</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;([iy])e(?!n)&quot;</span><span class="p">,</span>  <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;\1ᴇ&quot;</span> <span class="k">if</span> <span class="s2">&quot;IE_YUE_INC_SMALLCAPS_E&quot;</span>  <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                         <span class="sa">UR</span><span class="s2">&quot;\1e&quot;</span><span class="p">)),</span>  <span class="c1"># ie/yue/üe/ve，此前已转换{j/q/x}u</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;([iy])e(?!n)&quot;</span><span class="p">,</span>  <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;\1e&quot;</span> <span class="k">if</span> <span class="s2">&quot;IE_YUE_INC_E&quot;</span>            <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                         <span class="sa">UR</span><span class="s2">&quot;\1ɛ&quot;</span><span class="p">)),</span>  <span class="c1"># ie/yue是否采用[e]标明，此前已判断[E]</span>
    <span class="c1"># 舌面央中元音轻微过渡韵腹</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;iŋ&quot;</span><span class="p">,</span>       <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;iəŋ&quot;</span> <span class="k">if</span> <span class="s2">&quot;TRANSITIONAL_SCHWA_IN_ING&quot;</span>    <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                    <span class="sa">UR</span><span class="s2">&quot;iŋ&quot;</span><span class="p">)),</span>        <span class="c1"># ing是否有舌面央中元音韵腹</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;(un|uen)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;uən&quot;</span> <span class="k">if</span> <span class="s2">&quot;TRANSITIONAL_SCHWA_IN_UEN&quot;</span>    <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                    <span class="sa">UR</span><span class="s2">&quot;un&quot;</span><span class="p">)),</span>        <span class="c1"># 合口un/uen过渡，此前已排除撮口[j/q/x]un</span>
    <span class="c1"># 后移的a</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ao&quot;</span><span class="p">,</span>        <span class="sa">UR</span><span class="s2">&quot;ɑu&quot;</span><span class="p">),</span>         <span class="c1"># 包括ao/iao，o改为u</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;aŋ&quot;</span><span class="p">,</span>        <span class="sa">UR</span><span class="s2">&quot;ɑŋ&quot;</span><span class="p">),</span>         <span class="c1"># 包括ang/iang/uang</span>
    <span class="c1"># 韵母en/eng韵腹是舌面央中元音</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;e([nŋ])&quot;</span><span class="p">,</span>   <span class="sa">UR</span><span class="s2">&quot;ə\1&quot;</span><span class="p">),</span>
    <span class="c1"># ong类韵母</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ioŋ&quot;</span><span class="p">,</span>      <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;iuŋ&quot;</span> <span class="k">if</span> <span class="s2">&quot;IONG_BY_IUNG&quot;</span>                 <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                    <span class="sa">UR</span><span class="s2">&quot;yŋ&quot;</span><span class="p">)),</span>        <span class="c1"># iong的两种转换，此前yong已转换为iong</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;oŋ&quot;</span><span class="p">,</span>        <span class="sa">UR</span><span class="s2">&quot;uŋ&quot;</span><span class="p">),</span>         <span class="c1"># ong，此前已排除iong</span>
    <span class="c1">### 儿化音变——无需转换ar/ir/ur/aur/our/yur</span>
    <span class="c1"># 舌尖元音韵母</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;[ɿʅ]r&quot;</span><span class="p">,</span>     <span class="sa">UR</span><span class="s2">&quot;ər&quot;</span><span class="p">),</span>         <span class="c1"># {zh/ch/sh/r/z/c/s}ir</span>
    <span class="c1"># 鼻韵尾脱落和相应的韵腹元音替换</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;[aɛ][in]r&quot;</span><span class="p">,(</span><span class="sa">UR</span><span class="s2">&quot;ɐr&quot;</span> <span class="k">if</span> <span class="s2">&quot;AIR_ANR_INC_NEAR_OPEN_CENTRAL&quot;</span> <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                    <span class="sa">UR</span><span class="s2">&quot;ar&quot;</span><span class="p">)),</span>        <span class="c1"># air/anr韵尾脱落后的韵腹替换</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;eir|ənr&quot;</span><span class="p">,</span>   <span class="sa">UR</span><span class="s2">&quot;ər&quot;</span><span class="p">),</span>         <span class="c1"># eir韵腹央化，韵尾脱落；enr韵尾脱落</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;([iy])r&quot;</span><span class="p">,</span>   <span class="sa">UR</span><span class="s2">&quot;\1ər&quot;</span><span class="p">),</span>       <span class="c1"># ir/yr增加央化韵腹</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;([iuy])nr&quot;</span><span class="p">,</span> <span class="sa">UR</span><span class="s2">&quot;\1ər&quot;</span><span class="p">),</span>       <span class="c1"># inr/ynr/unr韵尾脱落后增加央化韵腹</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;iuŋr&quot;</span><span class="p">,</span>      <span class="sa">UR</span><span class="s2">&quot;iũr&quot;</span><span class="p">),</span>        <span class="c1"># iungr(iongr的可选变换)</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;([iuy])ŋr&quot;</span><span class="p">,</span> <span class="sa">UR</span><span class="s2">&quot;\1ə̃r&quot;</span><span class="p">),</span>      <span class="c1"># ingr/yngr/ungr韵尾脱落后增加央化鼻化韵腹</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ŋr&quot;</span><span class="p">,</span>        <span class="sa">UR</span><span class="s2">&quot;̃r&quot;</span><span class="p">),</span>         <span class="c1"># ang/eng韵尾儿化脱落后韵腹鼻化</span>
    <span class="c1">### 声母、韵母转换的善后扫尾工作</span>
    <span class="c1"># 处理儿化韵卷舌动作</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>        <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;˞&quot;</span> <span class="k">if</span> <span class="s2">&quot;RHOTICITY_BY_RHOTIC_HOOK&quot;</span>       <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                    <span class="sa">UR</span><span class="s2">&quot;r&quot;</span><span class="p">)),</span>         <span class="c1"># 是否先把儿化韵卷舌动作改为卷舌小钩</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;R&quot;</span><span class="p">,</span>        <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ʐ&quot;</span> <span class="k">if</span> <span class="s2">&quot;INITIAL_R_BY_VED_RETRO_FRIC&quot;</span>    <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span> 
                    <span class="sa">UR</span><span class="s2">&quot;r&quot;</span><span class="p">)),</span>         <span class="c1"># 恢复声母r，是否采用卷舌浊擦音表示声母r</span>
    <span class="c1"># 此前已处理完卷舌动作和声母，现在处理剩下的r字符的可选转换</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>        <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ɻ&quot;</span> <span class="k">if</span> <span class="s2">&quot;R_TURNED_WITH_HOOK&quot;</span>             <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                    <span class="sa">UR</span><span class="s2">&quot;r&quot;</span><span class="p">)),</span>         <span class="c1"># 是否严格采用卷舌通音符号[ɻ]</span>
    <span class="c1"># 恢复声母n</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>         <span class="sa">UR</span><span class="s2">&quot;n&quot;</span><span class="p">),</span>          <span class="c1"># 此前已处理完单元音韵母e和ie/yue</span>
    <span class="c1"># 其他选项</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ʰ&quot;</span><span class="p">,</span>        <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ʻ&quot;</span> <span class="k">if</span> <span class="s2">&quot;ASPIRATE_BY_TURNED_COMMA&quot;</span>       <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                    <span class="sa">UR</span><span class="s2">&quot;ʰ&quot;</span><span class="p">)),</span>         <span class="c1"># 是否采用反逗号送气符号</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ai&quot;</span><span class="p">,</span>       <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;æi&quot;</span> <span class="k">if</span> <span class="s2">&quot;AI_INC_NEAR_OPEN_FRONT&quot;</span>        <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                    <span class="sa">UR</span><span class="s2">&quot;ai&quot;</span><span class="p">)),</span>        <span class="c1"># （非儿化的）ai/uai韵腹为舌面前次开元音</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;ou&quot;</span><span class="p">,</span>       <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;əu&quot;</span> <span class="k">if</span> <span class="s2">&quot;OU_INC_SCHWA&quot;</span>                  <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                    <span class="sa">UR</span><span class="s2">&quot;ou&quot;</span><span class="p">)),</span>        <span class="c1"># ou/iou是否采用舌面央中元音韵腹</span>
    <span class="c1">### 声调</span>
    <span class="c1"># 先期处理</span>
    <span class="p">((</span><span class="sa">UR</span><span class="s2">&quot;[1-5]&quot;</span> <span class="k">if</span> <span class="s2">&quot;HIDE_ALL_TONE_VALUE&quot;</span>                      <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
      <span class="sa">UR</span><span class="s2">&quot;5&quot;</span><span class="p">),</span>       <span class="sa">UR</span><span class="s2">&quot;&quot;</span><span class="p">),</span>           <span class="c1"># 只隐藏轻声还是隐藏所有的声调转换</span>
    <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;([1-4])&quot;</span><span class="p">,</span>
      <span class="p">(</span><span class="sa">UR</span><span class="s2">&quot;&lt;sup&gt;\1&lt;/sup&gt;&quot;</span> <span class="k">if</span> <span class="s2">&quot;HTML_SUP_TAG_FOR_TONE_VALUE&quot;</span>     <span class="ow">in</span> <span class="n">prefSet</span> <span class="k">else</span>
                    <span class="sa">UR</span><span class="s2">&quot;(\1)&quot;</span><span class="p">)),</span>      <span class="c1"># 隔离单个数字调号</span>
    <span class="c1"># 标出普通话调值</span>
    <span class="p">(</span><span class="s2">&quot;([(&gt;])1([)&lt;])&quot;</span><span class="p">,</span> <span class="sa">UR</span><span class="s2">&quot;\1 55\2&quot;</span><span class="p">),</span>  <span class="c1"># 阴平（第一声）</span>
    <span class="p">(</span><span class="s2">&quot;([(&gt;])2([)&lt;])&quot;</span><span class="p">,</span> <span class="sa">UR</span><span class="s2">&quot;\1 35\2&quot;</span><span class="p">),</span>  <span class="c1"># 阳平（第二声）</span>
    <span class="p">(</span><span class="s2">&quot;([(&gt;])3([)&lt;])&quot;</span><span class="p">,</span> <span class="sa">UR</span><span class="s2">&quot;\1 214\2&quot;</span><span class="p">),</span> <span class="c1"># 上声（第三声）</span>
    <span class="p">(</span><span class="s2">&quot;([(&gt;])4([)&lt;])&quot;</span><span class="p">,</span> <span class="sa">UR</span><span class="s2">&quot;\1 51\2&quot;</span><span class="p">),</span>  <span class="c1"># 去声（第四声）</span>
    <span class="p">(</span><span class="s2">&quot;([(&gt;]) ([235])&quot;</span><span class="p">,</span><span class="sa">UR</span><span class="s2">&quot;\1\2&quot;</span><span class="p">)</span>      <span class="c1"># 去掉此前标调值时加上的空格</span>
    <span class="p">)</span>
    <span class="c1">### 以上，替换命令元组创建完成！</span>
    <span class="c1"># 编译正则表达式对象，以便反复使用</span>
    <span class="k">global</span> <span class="n">reList</span>
    <span class="n">reList</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">,</span> <span class="p">[</span><span class="n">pair</span><span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">cmdPairTuple</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">decodeLine</span><span class="p">(</span><span class="n">encodedLine</span><span class="p">):</span>
    <span class="sa">U</span><span class="sd">&quot;&quot;&quot;对每一行拼音字符串做字符编码页解码&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">decodedLine</span> <span class="o">=</span> <span class="n">encodedLine</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">UTF8</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>             <span class="c1"># 如果不是UTF-8</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">decodedLine</span> <span class="o">=</span> <span class="n">encodedLine</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">GB18030</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>         <span class="c1"># 如果GB-18030也不行</span>
            <span class="n">decodedLine</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span>  <span class="c1"># 解码失败，只能清空</span>
            <span class="k">global</span> <span class="n">decodingFailed</span>
            <span class="n">decodingFailed</span> <span class="o">=</span> <span class="bp">True</span>          <span class="c1"># 设置字符编码页解码失败标志</span>
    <span class="k">except</span> <span class="ne">UnicodeEncodeError</span><span class="p">:</span>             <span class="c1"># wx中可能出现编码错误</span>
        <span class="n">decodedLine</span> <span class="o">=</span> <span class="n">encodedLine</span>
    <span class="k">return</span> <span class="n">decodedLine</span>
<span class="k">def</span> <span class="nf">msgOnDecodingFailure</span><span class="p">(</span><span class="n">fileName</span> <span class="o">=</span> <span class="s2">&quot;标准输入流&quot;</span><span class="p">):</span>
    <span class="sa">U</span><span class="sd">&quot;&quot;&quot;针对字符编码页解码失败的文件在事后通过标准错误流提出警告&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">decodingFailed</span>
    <span class="k">if</span> <span class="n">decodingFailed</span><span class="p">:</span>                  <span class="c1"># 检查上次文件处理中是否出现解码错误</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="sa">U</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> 警告：</span><span class="si">%s</span><span class="s2">解码失败！&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fileName</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">GBK</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
        <span class="n">decodingFailed</span> <span class="o">=</span> <span class="bp">False</span>          <span class="c1"># 重置字符集码页解码失败标志为关闭</span>
<span class="k">def</span> <span class="nf">convertLine</span><span class="p">(</span><span class="n">pinyinLine</span><span class="p">):</span>
    <span class="sa">U</span><span class="sd">&quot;&quot;&quot;对每一行拼音字符串依次执行全部替换命令，像流编辑器sed一样工作&quot;&quot;&quot;</span>
    <span class="c1"># 以单个“#”开头的行不转换，当作注释行</span>
    <span class="k">if</span> <span class="n">pinyinLine</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pinyinLine</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;##&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pinyinLine</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>           <span class="c1"># 去掉开头的“#”后再返回</span>
    <span class="c1"># 以两个“#”开头的行，只保留一个“#”，然后继续</span>
    <span class="k">if</span> <span class="n">pinyinLine</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;##&quot;</span><span class="p">):</span>
        <span class="n">pinyinLine</span> <span class="o">=</span> <span class="n">pinyinLine</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">ipaLine</span> <span class="o">=</span> <span class="n">pinyinLine</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>        <span class="c1"># 大写字母在替换过程中另有意义</span>
    <span class="k">for</span> <span class="n">eachRe</span><span class="p">,</span> <span class="n">eachCmdPair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">reList</span><span class="p">,</span> <span class="n">cmdPairTuple</span><span class="p">):</span>
        <span class="n">ipaLine</span> <span class="o">=</span> <span class="n">eachRe</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">eachCmdPair</span><span class="p">[</span><span class="n">SUBST</span><span class="p">],</span> <span class="n">ipaLine</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ipaLine</span>
<span class="k">def</span> <span class="nf">convertPinyin2IPA</span><span class="p">(</span><span class="n">pinyinLines</span><span class="p">,</span> <span class="n">linesep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sa">U</span><span class="sd">&quot;&quot;&quot;将汉语拼音文稿转换为国际音标文稿</span>
<span class="sd">    参数pinyinLines是输入的字符串序列</span>
<span class="sd">    参数linesep是行分隔符（对于fp.readlines()或s.splitlines(True)的输入，缺省即可）&quot;&quot;&quot;</span>
    <span class="c1"># 逐行处理解码和转换，有利于减少解码带来的乱码行</span>
    <span class="n">ipaLines</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">convertLine</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="n">decodeLine</span><span class="p">,</span> <span class="n">pinyinLines</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">linesep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ipaLines</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">UTF8</span><span class="p">)</span>  <span class="c1"># 必须按UTF-8再encode一下</span>
<span class="c1">######################## 主干函数 ########################</span>
<span class="k">def</span> <span class="nf">Pinyin2IPA</span><span class="p">(</span><span class="n">pinyinLines</span><span class="p">,</span> <span class="o">*</span><span class="n">prefs</span><span class="p">):</span>
    <span class="sa">U</span><span class="sd">&quot;&quot;&quot;创建转换命令，并将汉语拼音文稿转换为国际音标文稿</span>
<span class="sd">        参数pinyinLines可以是字符串序列或单个字符串（后者也会包装进元组）</span>
<span class="sd">        参数收集元组prefs是一个控制命令元组创建的选项设置表&quot;&quot;&quot;</span>
    <span class="c1"># 根据设置表创建替换命令元组（设置表缺省时提供默认值）</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">prefs</span><span class="p">:</span>
        <span class="n">prefs</span> <span class="o">=</span> <span class="n">defaultPrefSet</span>
    <span class="n">createCmdPairTuple</span><span class="p">(</span><span class="n">prefs</span><span class="p">)</span>
    <span class="c1"># 将单个字符串包装进元组，以便逐行处理</span>
    <span class="c1">#www.iplaypy.com</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pinyinLines</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">pinyinLines</span> <span class="o">=</span> <span class="p">(</span><span class="n">pinyinLines</span><span class="p">,</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">convertPinyin2IPA</span><span class="p">(</span><span class="n">pinyinLines</span><span class="p">)</span>
<span class="c1">######################## 直接运行 ########################</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">glob</span><span class="o">,</span> <span class="nn">locale</span><span class="o">,</span> <span class="nn">sys</span>
    <span class="n">globFailMsg</span> <span class="o">=</span> <span class="sa">U</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> 错误：参数“</span><span class="si">%s</span><span class="s2">”不能匹配任何有效的文件名！&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">GBK</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span>
    <span class="n">readFailMsg</span> <span class="o">=</span> <span class="sa">U</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> 错误：文件“</span><span class="si">%s</span><span class="s2">”数据读取失败！&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">GBK</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;/?&quot;</span><span class="p">,</span> <span class="s2">&quot;/h&quot;</span><span class="p">,</span> <span class="s2">&quot;--help&quot;</span><span class="p">,</span> <span class="s2">&quot;-h&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">eachArg</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>              <span class="c1"># 遍历glob表达式参数</span>
                <span class="n">fileNameList</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">eachArg</span><span class="p">)</span>     <span class="c1"># 考虑DOS不负责glob解析</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">fileNameList</span><span class="p">:</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">globFailMsg</span><span class="o">%</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">eachArg</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">eachFileName</span> <span class="ow">in</span> <span class="n">fileNameList</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">Pinyin2IPA</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">eachFileName</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()))</span>
                            <span class="n">msgOnDecodingFailure</span><span class="p">(</span><span class="sa">U</span><span class="s2">&quot;文件“</span><span class="si">%s</span><span class="s2">”&quot;</span><span class="o">%</span><span class="n">eachFileName</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">readFailMsg</span><span class="o">%</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">eachFileName</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># 按照本地设置的编码方式输出模块文档作为简单帮助</span>
            <span class="n">language_dummy</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">getdefaultlocale</span><span class="p">()</span>
            <span class="k">print</span> <span class="p">(</span><span class="vm">__doc__</span><span class="o">%</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">Pinyin2IPA</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">readlines</span><span class="p">()))</span>
        <span class="n">msgOnDecodingFailure</span><span class="p">()</span>
<span class="c1">######################## 脚本结束 ########################</span>
</pre></div>
                </div><!-- /.entry-content -->
                <!-- 来必力City版安装代码 -->
                <div id="lv-container" data-id="city" data-uid="MTAyMC8zNjgwNi8xMzM0Mg==">
                    <script type="text/javascript">
                   (function(d, s) {
                       var j, e = d.getElementsByTagName(s)[0];

                       if (typeof LivereTower === 'function') { return; }

                       j = d.createElement(s);
                       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                       j.async = true;

                       e.parentNode.insertBefore(j, e);
                   })(document, 'script');
                    </script>
                <noscript> 为正常使用来必力评论功能请激活JavaScript</noscript>
                </div>
                <!-- City版安装代码已完成 -->
        </article>
</section>
        </div><!--/span-->

                <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
<li class="nav-header"><h4><i class="icon-external-link"></i>blogroll</h4></li>
    <li><a href="http://getpelican.com/"><i class="icon-external-link"></i>Pelican</a></li>
    <li><a href="http://python.org/"><i class="icon-external-link"></i>Python.org</a></li>
    <li><a href="http://jinja.pocoo.org/"><i class="icon-external-link"></i>Jinja2</a></li>
    <li><a href="http://www.runoob.com/"><i class="icon-external-link"></i>Python教程</a></li>
    <li><a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000"><i class="icon-external-link"></i>廖雪峰Python</a></li>
<li class="nav-header"><h4><i class="icon-home icon-large"></i> social</h4></li>
<li><a href="/feeds/all.atom.xml" rel="alternate"><i class="icon-bookmark icon-large"></i>atom feed</a></li>
    <li><a href="https://github.com/RuiJee"><i class="icon-Github-sign icon-large"></i>Github</a></li>

<li class="nav-header"><h4> <a href="/categories.html"><i class="icon-folder-close icon-large"></i>Categories</a></h4></li>
<li>
<a href="/category/code-example/index.html">
    <i class="icon-folder-open icon-large"></i>Code Example
</a>
</li>
<li>
<a href="/category/linux/index.html">
    <i class="icon-folder-open icon-large"></i>Linux
</a>
</li>
<li>
<a href="/category/pa-chong-ji-zhu/index.html">
    <i class="icon-folder-open icon-large"></i>爬虫技术
</a>
</li>
<li>
<a href="/category/pythonji-zhu/index.html">
    <i class="icon-folder-open icon-large"></i>Python技术
</a>
</li>

<li class="nav-header"><h4> <a href="/tags.html"><i class="icon-tags icon-large"></i>Tags</a></h4></li>
<li class="tag-4">
    <a href="/tag/centos/index.html">
        <i class="icon-tag icon-large"></i>centos
    </a>
</li>
<li class="tag-3">
    <a href="/tag/pycharm/index.html">
        <i class="icon-tag icon-large"></i>pycharm
    </a>
</li>
<li class="tag-3">
    <a href="/tag/python3/index.html">
        <i class="icon-tag icon-large"></i>python3
    </a>
</li>
<li class="tag-4">
    <a href="/tag/shu/index.html">
        <i class="icon-tag icon-large"></i>书
    </a>
</li>
<li class="tag-4">
    <a href="/tag/str/index.html">
        <i class="icon-tag icon-large"></i>str
    </a>
</li>
<li class="tag-3">
    <a href="/tag/iterator/index.html">
        <i class="icon-tag icon-large"></i>iterator
    </a>
</li>
<li class="tag-4">
    <a href="/tag/ci-yun/index.html">
        <i class="icon-tag icon-large"></i>词云
    </a>
</li>
<li class="tag-2">
    <a href="/tag/pa-chong/index.html">
        <i class="icon-tag icon-large"></i>爬虫
    </a>
</li>
<li class="tag-2">
    <a href="/tag/code_gui/index.html">
        <i class="icon-tag icon-large"></i>code_gui
    </a>
</li>
<li class="tag-4">
    <a href="/tag/tuple/index.html">
        <i class="icon-tag icon-large"></i>tuple
    </a>
</li>
<li class="tag-4">
    <a href="/tag/fudge/index.html">
        <i class="icon-tag icon-large"></i>fudge
    </a>
</li>
<li class="tag-4">
    <a href="/tag/zuo-yong-yu/index.html">
        <i class="icon-tag icon-large"></i>作用域
    </a>
</li>
<li class="tag-3">
    <a href="/tag/list/index.html">
        <i class="icon-tag icon-large"></i>list
    </a>
</li>
<li class="tag-4">
    <a href="/tag/virtualenv/index.html">
        <i class="icon-tag icon-large"></i>virtualenv
    </a>
</li>
<li class="tag-4">
    <a href="/tag/decorator/index.html">
        <i class="icon-tag icon-large"></i>decorator
    </a>
</li>
<li class="tag-1">
    <a href="/tag/code_base/index.html">
        <i class="icon-tag icon-large"></i>code_base
    </a>
</li>
<li class="tag-4">
    <a href="/tag/dian-zi-shu/index.html">
        <i class="icon-tag icon-large"></i>电子书
    </a>
</li>
<li class="tag-4">
    <a href="/tag/zhi-hu/index.html">
        <i class="icon-tag icon-large"></i>知乎
    </a>
</li>
<li class="tag-4">
    <a href="/tag/legb/index.html">
        <i class="icon-tag icon-large"></i>legb
    </a>
</li>
<li class="tag-3">
    <a href="/tag/shi-xian-yuan-li/index.html">
        <i class="icon-tag icon-large"></i>实现原理
    </a>
</li>
<li class="tag-4">
    <a href="/tag/re/index.html">
        <i class="icon-tag icon-large"></i>re
    </a>
</li>
<li class="tag-4">
    <a href="/tag/pip/index.html">
        <i class="icon-tag icon-large"></i>pip
    </a>
</li>
<li class="tag-4">
    <a href="/tag/jie-huo/index.html">
        <i class="icon-tag icon-large"></i>解惑
    </a>
</li>
<li class="tag-4">
    <a href="/tag/datetime/index.html">
        <i class="icon-tag icon-large"></i>datetime
    </a>
</li>
<li class="tag-4">
    <a href="/tag/zheng-ze-biao-da-shi/index.html">
        <i class="icon-tag icon-large"></i>正则表达式
    </a>
</li>
<li class="tag-4">
    <a href="/tag/cai-dan/index.html">
        <i class="icon-tag icon-large"></i>彩蛋
    </a>
</li>
<li class="tag-4">
    <a href="/tag/biao-qian-yun/index.html">
        <i class="icon-tag icon-large"></i>标签云
    </a>
</li>
<li class="tag-4">
    <a href="/tag/lambda/index.html">
        <i class="icon-tag icon-large"></i>lambda
    </a>
</li>
<li class="tag-4">
    <a href="/tag/ru-men/index.html">
        <i class="icon-tag icon-large"></i>入门
    </a>
</li>
<li class="tag-3">
    <a href="/tag/suan-fa/index.html">
        <i class="icon-tag icon-large"></i>算法
    </a>
</li>
<li class="tag-4">
    <a href="/tag/stringio/index.html">
        <i class="icon-tag icon-large"></i>stringio
    </a>
</li>
<li class="tag-4">
    <a href="/tag/rename/index.html">
        <i class="icon-tag icon-large"></i>rename
    </a>
</li>
<li class="tag-4">
    <a href="/tag/luan-ma/index.html">
        <i class="icon-tag icon-large"></i>乱码
    </a>
</li>
<li class="tag-3">
    <a href="/tag/dict/index.html">
        <i class="icon-tag icon-large"></i>dict
    </a>
</li>
<li class="tag-4">
    <a href="/tag/int/index.html">
        <i class="icon-tag icon-large"></i>int
    </a>
</li>
<li class="tag-4">
    <a href="/tag/singleton/index.html">
        <i class="icon-tag icon-large"></i>singleton
    </a>
</li>
<li class="tag-4">
    <a href="/tag/with/index.html">
        <i class="icon-tag icon-large"></i>with
    </a>
</li>
<li class="tag-4">
    <a href="/tag/python27/index.html">
        <i class="icon-tag icon-large"></i>python27
    </a>
</li>
<li class="tag-4">
    <a href="/tag/tornado/index.html">
        <i class="icon-tag icon-large"></i>tornado
    </a>
</li>
<li class="tag-1">
    <a href="/tag/code_demos/index.html">
        <i class="icon-tag icon-large"></i>code_Demos
    </a>
</li>
<li class="tag-3">
    <a href="/tag/han-shu/index.html">
        <i class="icon-tag icon-large"></i>函数
    </a>
</li>
<li class="tag-2">
    <a href="/tag/code_scripts-shell/index.html">
        <i class="icon-tag icon-large"></i>code_scripts-shell
    </a>
</li>
<li class="tag-4">
    <a href="/tag/code_mobile/index.html">
        <i class="icon-tag icon-large"></i>code_mobile
    </a>
</li>
<li class="tag-4">
    <a href="/tag/thread/index.html">
        <i class="icon-tag icon-large"></i>thread
    </a>
</li>
<li class="tag-2">
    <a href="/tag/code_game/index.html">
        <i class="icon-tag icon-large"></i>code_game
    </a>
</li>
<li class="tag-4">
    <a href="/tag/ming-ming-kong-jian/index.html">
        <i class="icon-tag icon-large"></i>命名空间
    </a>
</li>
<li class="tag-2">
    <a href="/tag/code_graphics/index.html">
        <i class="icon-tag icon-large"></i>code_graphics
    </a>
</li>
<li class="tag-4">
    <a href="/tag/beautifulsoup/index.html">
        <i class="icon-tag icon-large"></i>beautifulsoup
    </a>
</li>
<li class="tag-3">
    <a href="/tag/generator/index.html">
        <i class="icon-tag icon-large"></i>generator
    </a>
</li>
<li class="tag-4">
    <a href="/tag/metaclass/index.html">
        <i class="icon-tag icon-large"></i>metaclass
    </a>
</li>
<li class="tag-2">
    <a href="/tag/linux/index.html">
        <i class="icon-tag icon-large"></i>linux
    </a>
</li>
<li class="tag-4">
    <a href="/tag/django/index.html">
        <i class="icon-tag icon-large"></i>django
    </a>
</li>
<li class="tag-2">
    <a href="/tag/bian-ma/index.html">
        <i class="icon-tag icon-large"></i>编码
    </a>
</li>
<li class="tag-4">
    <a href="/tag/yield/index.html">
        <i class="icon-tag icon-large"></i>yield
    </a>
</li>
<li class="tag-1">
    <a href="/tag/code_algorithm/index.html">
        <i class="icon-tag icon-large"></i>code_algorithm
    </a>
</li>
<li class="tag-2">
    <a href="/tag/code_mail/index.html">
        <i class="icon-tag icon-large"></i>code_mail
    </a>
</li>
<li class="tag-2">
    <a href="/tag/code_linux/index.html">
        <i class="icon-tag icon-large"></i>code_linux
    </a>
</li>
<li class="tag-4">
    <a href="/tag/book/index.html">
        <i class="icon-tag icon-large"></i>book
    </a>
</li>
<li class="tag-1">
    <a href="/tag/code_text-file/index.html">
        <i class="icon-tag icon-large"></i>code_text-file
    </a>
</li>
<li class="tag-3">
    <a href="/tag/zhuang-shi-qi/index.html">
        <i class="icon-tag icon-large"></i>装饰器
    </a>
</li>
<li class="tag-4">
    <a href="/tag/extractor/index.html">
        <i class="icon-tag icon-large"></i>extractor
    </a>
</li>
<li class="tag-4">
    <a href="/tag/bi-bao/index.html">
        <i class="icon-tag icon-large"></i>闭包
    </a>
</li>
<li class="tag-4">
    <a href="/tag/intern/index.html">
        <i class="icon-tag icon-large"></i>intern
    </a>
</li>
<li class="tag-3">
    <a href="/tag/pythonic/index.html">
        <i class="icon-tag icon-large"></i>pythonic
    </a>
</li>
<li class="tag-4">
    <a href="/tag/timestamp/index.html">
        <i class="icon-tag icon-large"></i>timestamp
    </a>
</li>
<li class="tag-4">
    <a href="/tag/lsof/index.html">
        <i class="icon-tag icon-large"></i>lsof
    </a>
</li>
<li class="tag-4">
    <a href="/tag/free/index.html">
        <i class="icon-tag icon-large"></i>free
    </a>
</li>
<li class="tag-2">
    <a href="/tag/python/index.html">
        <i class="icon-tag icon-large"></i>python
    </a>
</li>
<li class="tag-4">
    <a href="/tag/gc/index.html">
        <i class="icon-tag icon-large"></i>gc
    </a>
</li>
<li class="tag-4">
    <a href="/tag/equals-identical/index.html">
        <i class="icon-tag icon-large"></i>equals-identical
    </a>
</li>
<li class="tag-2">
    <a href="/tag/code_security/index.html">
        <i class="icon-tag icon-large"></i>code_security
    </a>
</li>
<li class="tag-4">
    <a href="/tag/iterable/index.html">
        <i class="icon-tag icon-large"></i>iterable
    </a>
</li>
<li class="tag-3">
    <a href="/tag/requests/index.html">
        <i class="icon-tag icon-large"></i>requests
    </a>
</li>
<li class="tag-3">
    <a href="/tag/http/index.html">
        <i class="icon-tag icon-large"></i>http
    </a>
</li>
<li class="tag-1">
    <a href="/tag/code_other/index.html">
        <i class="icon-tag icon-large"></i>code_other
    </a>
</li>
<li class="tag-4">
    <a href="/tag/method/index.html">
        <i class="icon-tag icon-large"></i>method
    </a>
</li>
<li class="tag-4">
    <a href="/tag/djang-blog/index.html">
        <i class="icon-tag icon-large"></i>djang-blog
    </a>
</li>
<li class="tag-4">
    <a href="/tag/for/index.html">
        <i class="icon-tag icon-large"></i>for
    </a>
</li>


</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer>
        <!--<address id="about">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican <i class="icon-external-link"></i></a>,
                                which takes great advantage of <a href="http://python.org">Python <i class="icon-external-link"></i></a>.
        </address>--><!-- /#about -->

       <!-- <p>The theme is from <a href="http://twitter.github.com/bootstrap/">Bootstrap from Twitter <i class="icon-external-link"></i></a>,
                   and <a href="http://fortawesome.github.com/Font-Awesome/">Font-Awesome <i class="icon-external-link"></i></a>, thanks!</p>-->
         <p>&copy; Alex 2018</p>
      </footer>

    </div><!--/.fluid-container-->



    <!-- Le javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <!--<script src="/theme/js/jquery-1.7.2.min.js"></script>-->
    <script src="/theme/js/bootstrap.min.js"></script>
  </body>
</html>